<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <!-- КРИТИЧЕСКИ ВАЖНО для мобильной адаптации -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Панель FFH4X - Полный экран</title>
    <!-- Подключение Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Сброс стилей для полного экрана */
        body {
            background-color: black; 
            display: flex;
            align-items: flex-start; 
            justify-content: center;
            /* Убираем 100vh из body, чтобы избежать проблем с панелями браузера */
            margin: 0;
            padding: 0;
            overflow-y: auto; 
            font-family: 'Inter', sans-serif;
        }

        /* Основной контейнер, высота которого будет устанавливаться JS */
        .app-container {
            width: 100vw; 
            /* Высота будет установлена в JS (vhs-height) */
            max-width: 100%;
            background-color: black; 
            overflow-y: hidden; /* Скрываем общий скролл, скролл только внутри списка функций */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
       
        /* Скрываем элементы макета iPhone, которые больше не нужны */
        .iphone-body, .iphone-screen, .dynamic-island, .side-button {
            display: none !important;
        }


        /* Стиль для приложения (Теперь это основной контейнер контента) */
        .app-panel {
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 0; 
            position: relative; 
        }
       
        .panel-header {
            width: 100%;
            background-color: red; 
            color: white;
            text-align: center;
            padding: 15px 0; 
            font-size: 1.4rem;
            font-weight: bold;
            flex-shrink: 0; /* Не позволяет сжиматься */
        }

        /* Стиль для Этапа 1 (Ввод ID) */
        #stage1 {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1; 
        }

        /* Размер иконки 90x90px */
        .profile-icon {
            margin-top: 80px; 
            width: 90px; 
            height: 90px; 
            border-radius: 50%;
            background-color: black;
            border: 3px solid red;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 0, 0, 1.2), inset 0 0 15px rgba(255, 0, 0, 1); 
            margin-bottom: 0;
        }

        .id-input-wrapper {
            width: 90%;
            max-width: 400px; 
            background-color: #0a0a0a; 
            border-radius: 12px;
            padding: 30px 20px; 
            margin-top: 60px; 
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 0 25px rgba(255, 0, 0, 1.0), inset 0 0 10px rgba(255, 0, 0, 0.8);
        }
       
        .id-input-wrapper .enter-id-text {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 25px; 
            font-weight: bold; 
        }

        .id-input-container {
            width: 100%; 
            background-color: black;
            border: 2px solid red; 
            border-radius: 8px;
            padding: 15px; 
            color: white; 
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 25px; 
            box-shadow: 0 0 2px red, inset 0 0 2px red; 
            outline: none; 
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .id-input-container::placeholder {
            color: #A0A0A0; 
            opacity: 1; 
        }

        .continue-button {
            width: 100%; 
            background-color: red; 
            color: white;
            padding: 18px 0; 
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
            transition: background-color 0.2s;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .continue-button:hover { background-color: #e00; }

        /* --- Стили для Этапа 2 (Settings Panel) --- */
        #stage2 {
            width: 100%;
            max-width: 500px; 
            display: none; /* Изначально скрыт */
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            flex-grow: 1; /* Занимает все оставшееся место */
            /* Важно: overflow: hidden нужен, чтобы flex-grow: 1 у .functions-list-container работал корректно */
            overflow: hidden; 
        }
       
        .stage2-profile-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            margin-bottom: 30px;
            flex-shrink: 0; /* Не сжиматься */
        }
        .stage2-profile-area .profile-icon {
            margin-top: 10px; 
        }
        .profile-texts {
            margin-top: 15px;
            text-align: center;
            color: white;
        }
        .id-display {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ccc;
        }
        .username-display {
            font-size: 1rem;
            color: red;
            font-weight: 500;
        }
        .activation-title {
            color: white;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 25px;
            margin-top: 0;
            flex-shrink: 0; /* Не сжиматься */
        }

        /* Вкладки (Tabs) */
        .tabs-container {
            width: 95%;
            max-width: 400px; /* Ограничиваем ширину вкладок */
            display: flex;
            justify-content: space-around;
            background-color: black;
            border-bottom: 3px solid red; 
            margin-bottom: 20px;
            padding-bottom: 0px; 
            flex-shrink: 0;
        }
       
        .tab-wrapper {
            position: relative;
            flex-grow: 1; 
            text-align: center;
            margin: 0;
        }

        .tab {
            padding: 12px 5px; 
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            text-transform: uppercase;
            transition: color 0.2s;
            color: red; 
            background-color: black;
        }

        .tab-wrapper.active {
            z-index: 20; 
            margin-bottom: -3px; 
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); 
        }

        .tab-wrapper.active .tab {
            background-color: red;
            color: white;
            border-radius: 4px 4px 0 0;
            cursor: default;
        }
       
        /* Кнопка APPLY */
        .apply-button {
            width: 90%; 
            max-width: 400px;
            background-color: #333; 
            color: white;
            padding: 15px 0; 
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
            border: none;
            margin-top: 10px; 
            margin-bottom: 20px;
            flex-shrink: 0; /* Не позволяет сжиматься */
        }
        .apply-button.active {
            background-color: red; 
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
        }
        .apply-button:hover:not(.active) { background-color: #444; }


        /* Список функций и переключатели */
        .functions-list-container {
            width: 90%;
            max-width: 400px;
            flex-grow: 1; /* Занимает все доступное пространство */
            overflow-y: auto; /* Позволяем скроллить только этот блок */
            background-color: #0a0a0a; 
            border-radius: 8px;
            padding: 10px 20px;
            box-shadow: inset 0 0 5px rgba(255, 0, 0, 0.4);
            /* Убедимся, что flex-shrink 1 (по умолчанию), чтобы он мог сжиматься */
            /* Убрали min-height, чтобы flexbox мог сжать его до 0 при необходимости */
        }
        /* Убедимся, что functions-list использует всю доступную ширину контейнера */
        .functions-list {
            width: 100%;
        }

        .function-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #1a1a1a; 
            color: white;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .function-item:last-child {
            border-bottom: none;
        }
        .function-name {
            opacity: 0.9;
        }
       
        /* Стили для iOS-подобного переключателя (Toggle Switch) */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            flex-shrink: 0;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #333; 
            transition: .4s;
            border-radius: 28px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: #ccc;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: red; 
        }
        input:checked + .slider:before {
            transform: translateX(22px);
            background-color: white;
        }
       
        /* --- МОДАЛЬНОЕ ОКНО (Modal) --- */
        #loadingModal {
            position: fixed; 
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); 
            display: none; 
            justify-content: center;
            align-items: center;
            z-index: 50; 
            backdrop-filter: blur(4px);
        }

        .modal-content {
            width: 85%;
            max-width: 300px; 
            background-color: #1a1a1a; 
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            border: 3px solid red;
            box-shadow: 0 0 35px rgba(255, 0, 0, 1.5); 
        }
       
        .modal-info {
            margin-bottom: 20px;
        }
       
        .modal-info-text {
            color: #ccc;
            font-size: 1rem;
            margin-bottom: 8px;
        }
       
        .modal-username {
            color: red;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
       
        .modal-message {
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 22px;
        }
       
        /* Индикатор загрузки (Progress Bar) */
        #progressBarContainer {
            width: 100%;
            background-color: #333;
            border-radius: 5px;
            margin-bottom: 20px;
            height: 12px;
            overflow: hidden;
            border: 1px solid red;
        }
       
        #progressBar {
            height: 100%;
            width: 0%;
            background-color: red;
            transition: width 0.2s linear;
        }
       
        /* Кнопка OK/CLOSE */
        .modal-button {
            width: 100%;
            background-color: red;
            color: white;
            padding: 12px 0;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s;
        }
        .modal-button:hover {
            background-color: #cc0000;
        }
    </style>
</head>

<body>
    <!-- НОВЫЙ КОНТЕЙНЕР ДЛЯ ПОЛНОГО ЭКРАНА -->
    <div class="app-container">
        <!-- Приложение с плашкой (бывший app-panel) --><div class="app-panel">
            <div class="panel-header">PAINEL FFH4X</div>
           
            <!-- ЭТАП 1: Ввод ID -->
            <div id="stage1">
                <div class="profile-icon">
                    <img src="https://image.winudf.com/v2/image1/Y29tLmZmaDR4LmluamVjdG9yLmhhY2tfaWNvbl8xNjQzMjQ3NDQ3XzA4OQ/icon.webp?w=90&fakeurl=1&type=.webp" 
                        alt="Profile Icon" 
                        onerror="this.onerror=null; this.src='https://placehold.co/90x90/FF0000/000000?text=H4X%0ASkull';">
                </div>

                <div class="id-input-wrapper">
                    <div class="enter-id-text"><b>Enter your ID:</b></div>
                    <input
                        type="text"
                        id="userIdInput"
                        class="id-input-container"
                        placeholder="Your ID"
                        maxlength="12"
                        minlength="6" 
                    >
                    <div class="continue-button" onclick="handleContinue()">CONTINUE</div>
                </div>
            </div>

            <!-- ЭТАП 2: Панель настроек (Скрыта по умолчанию) -->
            <div id="stage2">
                <!-- Профиль/ID -->
                <div class="stage2-profile-area">
                    <div class="profile-icon">
                        <img src="https://image.winudf.com/v2/image1/Y29tLmZmaDR4LmluamVjdG9yLmhhY2tfaWNvbl8xNjQzMjQ3NDQ3XzA4OQ/icon.webp?w=90&fakeurl=1&type=.webp" 
                            alt="Profile Icon" 
                            onerror="this.onerror=null; this.src='https://placehold.co/90x90/FF0000/000000?text=H4X%0ASkull';">
                    </div>
                    <div class="profile-texts">
                        <div class="id-display">ID: <span id="displayedId">609214735</span></div>
                        <div class="username-display" id="displayedUsername">dem1n_25</div>
                    </div>
                </div>

                <div class="activation-title">Activate Functions</div>

                <!-- Вкладки (Tabs) -->
                <div class="tabs-container" id="tabsContainer">
                    <div class="tab-wrapper active" data-tab="aimbot" onclick="showTab('aimbot')">
                        <div class="tab">AIMBOT</div>
                    </div>
                    <div class="tab-wrapper" data-tab="esp" onclick="showTab('esp')">
                        <div class="tab">ESP</div>
                    </div>
                    <div class="tab-wrapper" data-tab="ghost" onclick="showTab('ghost')">
                        <div class="tab">GHOST</div>
                    </div>
                    <div class="tab-wrapper" data-tab="others" onclick="showTab('others')">
                        <div class="tab">OTHERS</div>
                    </div>
                </div>
               
                <!-- Контейнер для списков функций -->
                <div class="functions-list-container" id="functionsListContainer">
                   
                    <!-- AIMBOT Content (По умолчанию активен) -->
                    <div class="functions-list tab-content" id="aimbotContent">
                        <!-- AIMBOT -->
                        <div class="function-item">
                            <span class="function-name">AIMBOT</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="AIMBOT" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- AIMLOCK -->
                        <div class="function-item">
                            <span class="function-name">AIMLOCK</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="AIMLOCK" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- AUTO HEADSHOT -->
                        <div class="function-item">
                            <span class="function-name">AUTO HEADSHOT</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="AUTO HEADSHOT" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- AIM FOV (360) -->
                        <div class="function-item">
                            <span class="function-name">AIM FOV (360)</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="AIM FOV (360)" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- ESP Content (Скрыт по умолчанию) -->
                    <div class="functions-list tab-content" id="espContent">
                        <!-- ESP FIRE -->
                        <div class="function-item">
                            <span class="function-name">ESP FIRE</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="ESP FIRE" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- ESP LINE -->
                        <div class="function-item">
                            <span class="function-name">ESP LINE</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="ESP LINE" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- ESP NAME -->
                        <div class="function-item">
                            <span class="function-name">ESP NAME</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="ESP NAME" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- ESP DISTANCE -->
                        <div class="function-item">
                            <span class="function-name">ESP DISTANCE</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="ESP DISTANCE" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- GHOST Content (Скрыт по умолчанию) -->
                    <div class="functions-list tab-content" id="ghostContent">
                        <!-- GHOST HACK -->
                        <div class="function-item">
                            <span class="function-name">GHOST HACK</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="GHOST HACK" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- WALLHACK -->
                        <div class="function-item">
                            <span class="function-name">WALLHACK</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="WALLHACK" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- NO RECOIL -->
                        <div class="function-item">
                            <span class="function-name">NO RECOIL</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="NO RECOIL" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- OTHERS Content (Скрыт по умолчанию) -->
                    <div class="functions-list tab-content" id="othersContent">
                        <!-- MEDKIT RUN -->
                        <div class="function-item">
                            <span class="function-name">MEDKIT RUN</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="MEDKIT RUN" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- FAST RUN x2 -->
                        <div class="function-item">
                            <span class="function-name">FAST RUN x2</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="FAST RUN x2" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <!-- ANTIBAN -->
                        <div class="function-item">
                            <span class="function-name">ANTIBAN</span>
                            <label class="switch">
                                <input type="checkbox" data-feature="ANTIBAN" onchange="updateApplyButton()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                </div>
               
                <!-- Кнопка APPLY -->
                <button class="apply-button" id="applyButton" onclick="handleApply()">
                    APPLY
                </button>
            </div>
           
            <!-- Модальное окно для загрузки/инжекции -->
            <div id="loadingModal">
                <div class="modal-content">
                    <!-- ID и Юзернейм -->
                    <div class="modal-info">
                        <div class="modal-info-text">ID: <span id="modalId">609214735</span></div>
                        <div class="modal-username" id="modalUsername">dem1n_25</div>
                    </div>
                   
                    <!-- Прогресс-бар -->
                    <div id="progressBarContainer">
                        <div id="progressBar"></div>
                    </div>
                   
                    <!-- Сообщение об инжекции -->
                    <div class="modal-message" id="modalMessage">Processing...</div>

                    <!-- Кнопка OK/CLOSE (Появляется только после завершения) -->
                    <button class="modal-button" id="modalCloseButton" style="display: none;" onclick="closeModal()">
                        OK
                    </button>
                </div>
            </div>


        </div>

    </div>

    <script>
        // Функция для корректной установки высоты на мобильных устройствах
        function setViewportHeight() {
            // Устанавливаем --vhs-height в реальную высоту окна
            document.documentElement.style.setProperty('--vhs-height', `${window.innerHeight}px`);
            
            // Применяем эту высоту к .app-container
            const appContainer = document.querySelector('.app-container');
            if (appContainer) {
                appContainer.style.height = `var(--vhs-height)`;
            }
            
            // ----- УДАЛЕНО -----
            // Больше нет необходимости вызывать adjustFunctionsListHeight()
            // CSS (flexbox) теперь сам справляется с этим.
        }
       
        // Добавляем слушателей событий для установки высоты при загрузке и изменении размера
        window.addEventListener('load', setViewportHeight);
        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);


        // ----- УДАЛЕНО -----
        // Функция adjustFunctionsListHeight() была удалена.
        // CSS (flex-grow: 1 и overflow: auto на .functions-list-container)
        // является более надежным решением.
       
        // Имитируем получение имени пользователя по ID
        function getUsernameById(id) {
            // Очень простая имитация.
            if (id.length >= 8 && id.includes('0')) {
                return "ProPlayerX" + id.slice(-3);
            }
            // Имя пользователя по умолчанию
            return "dem1n_25";
        }
       
        // Массив сообщений для имитации процесса инжекции
        const injectionMessages = [
            "Initializing secure connection...",
            "Validating user credentials...",
            "Bypassing anticheat module...",
            "Injecting core engine files...",
            "Patching game memory...",
            "Running final checks..."
        ];

        // Функция для обновления состояния кнопки APPLY (красный/серый)
        function updateApplyButton() {
            const applyButton = document.getElementById('applyButton');
            // Проверяем, есть ли хотя бы один включенный (checked) переключатель ВО ВСЕХ ВКЛАДКАХ
            const anySwitchChecked = document.querySelectorAll('#stage2 input[type="checkbox"]:checked:not([disabled])').length > 0;

            if (anySwitchChecked) {
                // Если есть включенные, делаем кнопку красной и активной
                applyButton.classList.add('active');
                applyButton.disabled = false;
            } else {
                // Если все выключены, делаем кнопку серой и неактивной
                applyButton.classList.remove('active');
                applyButton.disabled = true;
            }
        }
       
        // Функция для обработки нажатия кнопки "CONTINUE"
        function handleContinue() {
            const stage1 = document.getElementById('stage1');
            const stage2 = document.getElementById('stage2');
            const input = document.getElementById('userIdInput');
            const displayedId = document.getElementById('displayedId');
            const displayedUsername = document.getElementById('displayedUsername');
            const id = input.value.trim();
            const button = document.querySelector('.continue-button');

            // Проверяем, что ID имеет не менее 6 символов
            if (id.length >= 6) { 
                // Имитация успешного действия
                const username = getUsernameById(id);
               
                // Устанавливаем текст без многоточия
                button.textContent = 'ACCESS GRANTED'; 
                button.style.backgroundColor = 'green';
                button.style.boxShadow = '0 0 15px rgba(0, 255, 0, 0.6)';
                input.disabled = true;

                // Задержка перед переходом на Stage 2
                setTimeout(() => {
                    // 1. Обновляем отображаемый ID и Username на Stage 2
                    displayedId.textContent = id; 
                    displayedUsername.textContent = username;
                   
                    // 2. Переключаем этапы
                    stage1.style.display = 'none';
                    stage2.style.display = 'flex';
                   
                    // 3. Убедимся, что мы на AIMBOT и обновляем состояние кнопки APPLY
                    showTab('aimbot');
                   
                    // 4. (ИЗМЕНЕНО) Вызываем setViewportHeight() на случай, если
                    //    появление клавиатуры изменило размер окна.
                    setViewportHeight();
                   
                    // 5. Возвращаем исходный текст кнопки на всякий случай
                    button.textContent = 'CONTINUE'; 
                    button.style.backgroundColor = 'red';
                    button.style.boxShadow = '0 0 15px rgba(255, 0, 0, 0.6)';
                    input.disabled = false;
                    input.value = ""; 
                }, 1000);
               
            } else {
                // Имитация ошибки или требования ввода
                const originalText = button.textContent;
               
                // Динамическое сообщение об ошибке
                const errorMessage = (id.length === 0) 
                    ? 'Enter ID first!' 
                    : 'Min length is 6 characters!'; 

                button.textContent = errorMessage;
                button.style.backgroundColor = '#8B0000'; // Темно-красный
                button.style.boxShadow = '0 0 15px rgba(255, 100, 100, 0.8)';
               
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.backgroundColor = 'red';
                    button.style.boxShadow = '0 0 15px rgba(255, 0, 0, 0.6)';
                }, 1500);
            }
        }

        // Функция для переключения вкладок
        function showTab(tabName) {
            // 1. Скрыть весь контент вкладок
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });

            // 2. Деактивировать все обертки вкладок (сбросить стили)
            document.querySelectorAll('.tab-wrapper').forEach(wrapper => {
                wrapper.classList.remove('active');
            });

            // 3. Активировать выбранный контент и обертку
            const targetContent = document.getElementById(tabName + 'Content');
            const targetWrapper = document.querySelector(`.tab-wrapper[data-tab="${tabName}"]`);
            
            if (targetContent) {
                targetContent.style.display = 'block';
            }
            if (targetWrapper) {
                targetWrapper.classList.add('active');
            }
            
            // 4. Обновить состояние кнопки APPLY
            updateApplyButton();
        }

        // Функция для обработки нажатия кнопки "APPLY"
        function handleApply() {
            // 1. Проверяем, активна ли кнопка
            const applyButton = document.getElementById('applyButton');
            if (applyButton.disabled || !applyButton.classList.contains('active')) {
                return; // Ничего не делаем, если нечего применять
            }

            // 2. Собрать все включенные функции
            const enabledFeatures = [];
            document.querySelectorAll('#stage2 input[type="checkbox"]:checked:not([disabled])').forEach(input => {
                enabledFeatures.push(input.getAttribute('data-feature'));
            });

            // 3. Получить ID и Username
            const id = document.getElementById('displayedId').textContent;
            const username = document.getElementById('displayedUsername').textContent;

            // 4. Показать модальное окно
            const modal = document.getElementById('loadingModal');
            document.getElementById('modalId').textContent = id;
            document.getElementById('modalUsername').textContent = username;
            document.getElementById('modalMessage').textContent = 'Processing...';
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('modalCloseButton').style.display = 'none';
            modal.style.display = 'flex';

            // 5. Запустить имитацию инжекции
            simulateInjection(enabledFeatures);
        }

        // Функция имитации инжекции с прогресс-баром
        function simulateInjection(features) {
            const progressBar = document.getElementById('progressBar');
            const modalMessage = document.getElementById('modalMessage');
            const closeButton = document.getElementById('modalCloseButton');
            const applyButton = document.getElementById('applyButton');

            // Блокируем все переключатели на время инжекции
            const allToggles = document.querySelectorAll('#stage2 input[type="checkbox"]');
            allToggles.forEach(toggle => toggle.disabled = true);
            
            // Блокируем кнопку APPLY
            applyButton.disabled = true;
            applyButton.textContent = 'INJECTING...';

            let progress = 0;
            const totalSteps = injectionMessages.length;
            const intervalTime = 600; // 0.6 секунды на шаг

            const interval = setInterval(() => {
                progress++;
                const percentage = Math.min(100, Math.round((progress / totalSteps) * 100));
                
                // Обновляем прогресс-бар
                progressBar.style.width = percentage + '%';
                
                // Обновляем сообщение (если есть)
                if (progress <= totalSteps) {
                    modalMessage.textContent = injectionMessages[progress - 1] || 'Finalizing...';
                }

                // Завершение
                if (progress > totalSteps) {
                    clearInterval(interval);
                    
                    // Показываем сообщение об успехе
                    modalMessage.textContent = 'INJECTION SUCCESSFUL!';
                    progressBar.style.width = '100%';
                    progressBar.style.backgroundColor = 'green';
                    
                    // Показываем кнопку "OK"
                    closeButton.style.display = 'block';
                }
            }, intervalTime);
        }

        // Функция для закрытия модального окна
        function closeModal() {
            const modal = document.getElementById('loadingModal');
            modal.style.display = 'none';
            
            // Сбрасываем прогресс-бар
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = '0%';
            progressBar.style.backgroundColor = 'red';

            // Разблокируем все переключатели и сбрасываем их
            const allToggles = document.querySelectorAll('#stage2 input[type="checkbox"]');
            allToggles.forEach(toggle => {
                toggle.disabled = false;
                toggle.checked = false; // Сбрасываем состояние
            });
            
            // Сбрасываем кнопку APPLY
            const applyButton = document.getElementById('applyButton');
            applyButton.textContent = 'APPLY';
            updateApplyButton(); // Обновит ее состояние на "серую"
        }
        
        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', () => {
            // Показываем первую вкладку
            showTab('aimbot');
            // Устанавливаем начальное состояние кнопки
            updateApplyButton();
        });

    </script>
</body>
</html>
